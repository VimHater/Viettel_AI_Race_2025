"Bao cao Decision Tree\n\nBT0 24520826\n\nNgay 5 thang 10 nam 2025\n\n## 1 Dinh nghia\n\n**Decision Tree (DT)** la mot thuat toan **hoc co giam sat (Supervised Learning)** phi tham so (non-parametric) dutoc su dung cho ca bai toan **Phan loai (Classification)** va **Hoi quy (Regression)**. Mo hinh hoat dong bang cach tao ra mot cau truc cay phan cap, trong do moi nut the hien mot quyet dinh hoac mot ket qua.\n\n### Cau Tric Co Ban\n\nMot Cay Quyet dinh bao gom cac thanh phan chinh sau:\n\n1. **Root Node (Nut Goc):** Nut bat dau, dai dien cho toan bo tap dur lieu.\n2. **Internal Node (Nut Quyet Dinh):** The hien mot phep thu tren mot thuoc tinh (feature). Cac nhanh (branch) tur nut nay la cac ket qua co the co cua phep thu.\n3. **Leaf Node (Nut La/Nut Ket Thuc):** Cac nut cuoi cung cua cay, dai dien cho ket qua phan loai (nhan ldp) hoac gia tri du doan (cho hoi quy).\n\n### Cach Thuc Hoat Dong\n\nViec xay dung cay duta tren qua trinh **phan hoach de quy** (recursive partitioning), su dung chien lutoc **tham lam** (greedy approach):\n\n1. **Lua chon Thuoc tinh Tot nhat:** O moi nut, thuat toan chon thuoc tinh t ot nhat de chia dur lieu, nham muc dich tao ra cac tap con **thuan khiet** (pure) nhat co the (dur lieu trong moi tap con cang thuoc ve mot lop duy nhat cang tot).\n2. **Tieu chi Chia Tach:** Cac tieu chi toan hoc thuong duoc su dung de danh gia chat lutong cua mot lan chia tach bao gom:* **Entropy (Do Hon Loan) va Information Gain (Do Loi Thong Tin):** Entropy do luong muc do khong chac chan. Muc tieu la chon thuoc tinh mang lai **Information Gain** cao nhat (gam Entropy lon nhat). \\[H(S)=-\\sum_{i=1}^{c}p_{i}\\log_{2}(p_{i})\\] Voi \\(p_{i}\\) la ty le cia lop \\(i\\) trong tap hop \\(S\\).\n* **Gini Impurity (Do Tap Gini):** Gini Impurity do luong kha nang mot phan tu ducc chon ngau nhien t t tap hop se bi gan nham nhan neu no dutoc gan nhan mot cach ngau nhien theo phan phoi nhan trong tap hop. Muc tieu la chon thuoc tinh co do giam Gini Impurity lon nhat. \\[G(S)=1-\\sum_{i=1}^{c}p_{i}^{2}\\]\n3. **Phan Chia De Quy:** Qua trinh nay duuc lap lai tren cac tap con cho den khi dat duoc dieu kien durng (vi du: nut tro nen thuan khiet hoac dat den do sau toi da cua cay).\n\n## 2. Thuat toan CART tong Scikit-learn\n\n**Scikit-learn** su dung phien ban toi uu cua thuat toan **CART** (**C**lassification And **Regression **T**rees).\n\n* CART xay dung **cay nhi phan** (binary trees): moi nit chi chia du lieu thanh hai nhanh con.\n* Thuat toan nay su dung cach tiep can **tham lam** (greedy algorithm), noi quvet dinh toi tu cuc bo duqc dua ra a moi nut dua tren viec giam do tap (impurity) lon nhat.\n\n### Tieu Chi Phan Chia (Impurity/Loss Function)\n\nTai moi nut \\(m\\) voi \\(n_{m}\\) mau, thuat toan tim kiem mot tham so chia tach \\(\\theta=(j,t_{m})\\) (gom thuoc tinh \\(j\\) va nguong \\(t_{m}\\)) de giam thieu do tap \\(G(Q_{m},\\theta)\\).\n\n* **Phan loai (Classification):** Thuong su dung **Gini Impurity** hoac **Entropy** (tuong duong voi Information Gain) de danh gia do thuan khiet cua nut.\n* **Hoi quy (Regression):** Thuong su dung **Mean Squared Error (MSE)** hoac **Mean Absolute Error (MAE)** lam ham mat mat.\n\nCong thuc tinh do tap trung binh cua mot lan chia tach:\n\n\\[G(Q_{m},\\theta)=\\frac{n_{m}^{\\rm left}}{n_{m}}H(Q_{m}^{\\rm left}(\\theta))+ \\frac{n_{m}^{\\rm right}}{n_{m}}H(Q_{m}^{\\rm right}(\\theta))\\]\n\nvoi \\(H()\\) la ham do tap (hoac ham mat mat) va \\(\\theta^{*}=\\arg\\min_{\\theta}G(Q_{m},\\theta)\\).\n\n## 3 Uu va Nhucc Diem theo Scikit-learn\n\n### Uu Diem\n\n* **De Giai thich va Truc quan hoa:** La mo hhnh **hop trang** (white box). Quy tac quyet dinh de dang duqc giai thich bang logic Boolean.\n* **It Can Tien Xu Ly Du lieu:** It yeu cau chuan hoa du lieu (normalization) hoac tao bien gia (dummy variables).\n* **Xu ly Dur lieu Hon hdp:** Co kha nang xu ly ca du lieu **so** (numerical) va **phan loai** (categorical) (mac du hien tai trien khai cua scikit-learn chua ho tr truc tiep bien phan loai).\n* **Chi phi Du doan Thap:** Chi phi su dung cay (tuc la du doan du lieu moi) la **logarit** trong so lutong diem du lieu dutoc su dung de huan luyen cay: \\(O(\\log(\\nundersundersundersunders))\\).\n\n\n\n### Nhucc Diem\n\n* **Overfitting (Hoc Qua Khop):** Cay co the tro nen qua phuc tap va khong tong quat hoa tot. Can su dung cac co che nhut c**at tia (pruning), gioi han max_depth (do sau toi da), hoac min_samples_leaf (so mau toi thieu o nut la).\n* **Khong On dinh (Unstable):** Su thay doi nho tong du lieu co the dan den mot cay hoan toan khac. Van de nay duoc glam nhe bang cach su dung **mo hinh Ensemble** (vi du: Random Forest).\n* **Kho hoc cac Khai niem Phuc tap:** Kho bieu dien cac van de nhut XOR hoac parity.\n* **Thien vi (Bias) Lop Chiem Uu The:** Cay co xu huong thien vi neu cac lop khong duoc can bang. Khuyen nghi **can bang tap du lieu** truc khi huan luyen.\n\n## 4 Thu vien Scikit-learn\n\n### Vi du\n\n``` from sklearn.datasetsimportload_iris from sklearn.treeimportDecisionTreeClassifier from sklearn.treeimportexport_text\n#1.Downloaddataset iris=load_iris() X, y=iris.data,iris.target\n#2.Initialandtrainmodel clf=DecisionTreeClassifier(max_depth=2,random_state=42) clf.fit(X,y)\n#3.Predict prediction=clf.predict([[5.0,3.6,1.3,0.2]])\n#4.Exportintext r=export_text(clf,feature_names=iris['feature_names'])\n\n### Demo\n\n[https://colab.research.google.com/drive/1S4MV7PAORBq05gkpoRQoHvzs7DVb7Z6F7usp=sharing](https://colab.research.google.com/drive/1S4MV7PAORBq05gkpoRQoHvzs7DVb7Z6F7usp=sharing)"